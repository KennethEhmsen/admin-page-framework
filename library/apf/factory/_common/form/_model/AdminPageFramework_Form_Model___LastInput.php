<?php
/**
 Admin Page Framework v3.7.8b01 by Michael Uno
 Generated by PHP Class Files Script Generator <https://github.com/michaeluno/PHP-Class-Files-Script-Generator>
 <http://en.michaeluno.jp/admin-page-framework>
 Copyright (c) 2013-2015, Michael Uno; Licensed under MIT <http://opensource.org/licenses/MIT>
 */
class AdminPageFramework_Form_Model___LastInput extends AdminPageFramework_FrameworkUtility {
    static private $_aLastInputs = array();
    public $sCallerID;
    public $sTransientKey;
    public function __construct($sCallerID) {
        $this->sCallerID = $sCallerID;
        $this->sTransientKey = 'apf_tfd_' . md5($this->getPageNow() . get_current_user_id());
    }
    public function set($aLastInputs) {
        if (empty(self::$_aLastInputs)) {
            add_action('shutdown', array($this, '_replyToSave'));
        }
        $_sID = $this->sCallerID;
        self::$_aLastInputs[$_sID] = isset(self::$_aLastInputs[$_sID]) ? $this->uniteArrays(self::$_aLastInputs[$_sID], $aLastInputs) : $aLastInputs;
    }
    public function _replyToSave() {
        if (!isset(self::$_aLastInputs)) {
            return;
        }
        $this->setTransient($this->sTransientKey, self::$_aLastInputs, 60 * 60);
    }
    public function get() {
        if (isset(self::$_aCaches[$this->sTransientKey])) {
            $_aLastInputs = self::$_aCaches[$this->sTransientKey];
        } else {
            $_aLastInputs = $this->getTransient($this->sTransientKey);
            self::$_aCaches[$this->sTransientKey] = $_aLastInputs;
            if (false !== $_aLastInputs) {
                $this->delete();
            }
        }
        return $this->getElementAsArray($_aLastInputs, $this->sCallerID, array());
    }
    private static $_aCaches = array();
    public function delete() {
        add_action('shutdown', array($this, '_replyToDelete'));
    }
    public function _replyToDelete() {
        $this->deleteTransient($this->sTransientKey);
    }
}